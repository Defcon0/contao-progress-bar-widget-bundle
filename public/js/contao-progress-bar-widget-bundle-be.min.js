class ContaoProgressBarWidgetBundleBackend{static init(){ContaoProgressBarWidgetBundleBackend.initAjaxReload()}static initAjaxReload(){let e=document.querySelectorAll(".huh-progress-bar");!(e.length<1)&&(ContaoProgressBarWidgetBundleBackend.updateWidgets(e),setInterval(()=>{ContaoProgressBarWidgetBundleBackend.updateWidgets(e)},2e3))}static updateWidgets(e){e.forEach(e=>{"in_progress"===e.getAttribute("data-state")&&fetch(e.getAttribute("data-progress-url")).then(e=>{if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);return e.text()}).then(t=>{if(t=JSON.parse(t),e.setAttribute("data-state",t.state),e.querySelector(".progress-bar > span").style="width: "+100*t.currentProgress/t.totalCount+"%",null!==e.querySelector(".numbers")&&(e.querySelector(".numbers .current-progress").innerHTML=t.currentProgress,e.querySelector(".numbers .total-count").innerHTML=t.totalCount,e.querySelector(".numbers .skipped-count").innerHTML=t.skippedCount),null!==e.querySelector(".messages")&&t.hasOwnProperty("messages")&&t.messages.length>0){let s=[];for(let[r,a]of(e.querySelector(".messages").classList.contains("invisible")&&e.querySelector(".messages").classList.remove("invisible"),Object.entries(t.messages)))console.log(a),s.push('<p class="'+a.class+'">'+a.text+"</p>");e.querySelector(".messages .wrapper").innerHTML=s.join("")}else e.querySelector(".messages").classList.contains("invisible")||e.querySelector(".messages").classList.add("invisible")}).catch(e=>{console.error("Fetch error:",e)})})}}document.addEventListener("DOMContentLoaded",ContaoProgressBarWidgetBundleBackend.init);
